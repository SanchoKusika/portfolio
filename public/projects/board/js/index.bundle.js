!function(){"use strict";function e(e){if(0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(1))+" "+["Bytes","KB","MB","GB"][t]}function t(e){return{"application/pdf":'<svg viewBox="0 0 24 24" fill="none" stroke="#ff4444"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><path d="M14 2v6h6"/><path d="M9 13h6"/><path d="M9 17h6"/><path d="M9 9h1"/></svg>',"application/msword":'<svg viewBox="0 0 24 24" fill="none" stroke="#4444ff"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><path d="M14 2v6h6"/><path d="M9 13h6"/><path d="M9 17h6"/><path d="M9 9h1"/></svg>',"application/vnd.openxmlformats-officedocument.wordprocessingml.document":'<svg viewBox="0 0 24 24" fill="none" stroke="#4444ff"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><path d="M14 2v6h6"/><path d="M9 13h6"/><path d="M9 17h6"/><path d="M9 9h1"/></svg>',"application/vnd.ms-excel":'<svg viewBox="0 0 24 24" fill="none" stroke="#44ff44"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><path d="M14 2v6h6"/><path d="M9 13h6"/><path d="M9 17h6"/><path d="M9 9h1"/></svg>',"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":'<svg viewBox="0 0 24 24" fill="none" stroke="#44ff44"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><path d="M14 2v6h6"/><path d="M9 13h6"/><path d="M9 17h6"/><path d="M9 9h1"/></svg>',"application/zip":'<svg viewBox="0 0 24 24" fill="none" stroke="#ff8800"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><path d="M14 2v6h6"/><path d="M9 13h6"/><path d="M9 17h6"/><path d="M9 9h1"/></svg>',"application/x-rar-compressed":'<svg viewBox="0 0 24 24" fill="none" stroke="#ff8800"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><path d="M14 2v6h6"/><path d="M9 13h6"/><path d="M9 17h6"/><path d="M9 9h1"/></svg>',"application/x-7z-compressed":'<svg viewBox="0 0 24 24" fill="none" stroke="#ff8800"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><path d="M14 2v6h6"/><path d="M9 13h6"/><path d="M9 17h6"/><path d="M9 9h1"/></svg>'}[e]||'<svg viewBox="0 0 24 24" fill="none" stroke="#666666"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><path d="M14 2v6h6"/><path d="M9 13h6"/><path d="M9 17h6"/><path d="M9 9h1"/></svg>'}function s(){const e=document.querySelectorAll(".auth__tab"),t=document.querySelectorAll(".auth__form");e.forEach((s=>{s.addEventListener("click",(()=>{const a=s.dataset.tab;e.forEach((e=>e.classList.remove("active"))),s.classList.add("active"),t.forEach((e=>{e.classList.contains("active")&&(e.style.opacity="0",e.style.transform="translateY(20px)",setTimeout((()=>{e.classList.remove("active");const t=document.querySelector(`.auth__form--${a}`);t&&(t.classList.add("active"),t.offsetHeight,t.style.opacity="1",t.style.transform="translateY(0)")}),300))}))}))}))}"undefined"!=typeof document&&document.addEventListener("DOMContentLoaded",s);class a{constructor(){this.createSessionBtn=document.querySelector(".board__create-session-btn"),this.createSessionModal=document.getElementById("createSessionModal"),this.closeButtons=document.querySelectorAll(".modal__close-btn"),this.cancelButtons=document.querySelectorAll(".modal__cancel-btn"),this.searchInput=this.createSessionModal?.querySelector(".modal__search .modal__input"),this.searchBtn=this.createSessionModal?.querySelector(".modal__search-btn"),this.usersList=this.createSessionModal?.querySelector(".modal__users-list"),this.selectedList=this.createSessionModal?.querySelector(".modal__selected-list"),this.selectedUsers=new Set,this.mockUsers=[{id:1,name:"Иван Иванов",email:"ivan@example.com"},{id:2,name:"Петр Петров",email:"petr@example.com"},{id:3,name:"Анна Сидорова",email:"anna@example.com"}],this.init()}init(){this.createSessionBtn?.addEventListener("click",(()=>{this.openModal(this.createSessionModal)})),this.closeButtons.forEach((e=>{e.addEventListener("click",(()=>{const t=e.closest(".modal");this.closeModal(t)}))})),this.cancelButtons.forEach((e=>{e.addEventListener("click",(()=>{const t=e.closest(".modal");this.closeModal(t)}))})),this.searchInput?.addEventListener("input",this.debounce((()=>{this.searchUsers(this.searchInput.value)}),300)),this.searchBtn?.addEventListener("click",(()=>{this.searchUsers(this.searchInput.value)})),document.addEventListener("click",(e=>{e.target.classList.contains("modal")&&this.closeModal(e.target)})),document.addEventListener("keydown",(e=>{if("Escape"===e.key){const e=document.querySelector(".modal.active");e&&this.closeModal(e)}}))}openModal(e){e&&(e.classList.add("active"),document.body.style.overflow="hidden",this.searchUsers(""))}closeModal(e){e&&(e.classList.remove("active"),document.body.style.overflow="",this.selectedUsers.clear(),this.updateSelectedList(),this.searchInput.value="")}searchUsers(e){const t=this.mockUsers.filter((t=>t.name.toLowerCase().includes(e.toLowerCase())||t.email.toLowerCase().includes(e.toLowerCase())));this.renderUsersList(t)}renderUsersList(e){this.usersList&&(this.usersList.innerHTML=e.map((e=>`\n\t\t\t<div class="modal__user-item ${this.selectedUsers.has(e.id)?"selected":""}" data-user-id="${e.id}">\n\t\t\t\t<div class="modal__user-avatar">${e.name.charAt(0)}</div>\n\t\t\t\t<div class="modal__user-info">\n\t\t\t\t\t<div class="modal__user-name">${e.name}</div>\n\t\t\t\t\t<div class="modal__user-email">${e.email}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`)).join(""),this.usersList.querySelectorAll(".modal__user-item").forEach((e=>{e.addEventListener("click",(()=>{const t=parseInt(e.dataset.userId);this.selectedUsers.has(t)?(this.selectedUsers.delete(t),e.classList.remove("selected")):(this.selectedUsers.add(t),e.classList.add("selected")),this.updateSelectedList()}))})))}updateSelectedList(){if(!this.selectedList)return;const e=this.mockUsers.filter((e=>this.selectedUsers.has(e.id)));this.selectedList.innerHTML=e.map((e=>`\n\t\t\t<div class="modal__selected-user">\n\t\t\t\t<div class="modal__user-avatar">${e.name.charAt(0)}</div>\n\t\t\t\t<div class="modal__user-name">${e.name}</div>\n\t\t\t\t<button class="modal__remove-user-btn" data-user-id="${e.id}" aria-label="Remove user">\n\t\t\t\t\t<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t\t<path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" />\n\t\t\t\t\t</svg>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t`)).join(""),this.selectedList.querySelectorAll(".modal__remove-user-btn").forEach((e=>{e.addEventListener("click",(t=>{t.stopPropagation();const s=parseInt(e.dataset.userId);this.selectedUsers.delete(s),this.updateSelectedList();const a=this.usersList.querySelector(`[data-user-id="${s}"]`);a&&a.classList.remove("selected")}))}))}debounce(e,t){let s;return function(...a){clearTimeout(s),s=setTimeout((()=>{clearTimeout(s),e(...a)}),t)}}}document.addEventListener("DOMContentLoaded",(()=>{(function(){const s=new Swiper(".files-swiper",{slidesPerView:"4",spaceBetween:20,centeredSlides:!1,pagination:{el:".swiper-pagination",clickable:!0},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}}),a=document.querySelector(".files__upload-btn"),n=document.querySelector(".files__input"),o=document.querySelector(".swiper-wrapper"),d=document.createElement("div");function i(){const e=o.querySelectorAll(".swiper-slide").length>0;d.style.display=e?"none":"flex"}d.className="swiper-empty-state",d.textContent="Загрузите файлы для их отображения",o.appendChild(d),i(),a.addEventListener("click",(()=>{n.click()})),n.addEventListener("change",(async a=>{const n=Array.from(a.target.files);for(const s of n){const a=document.createElement("div");a.className="swiper-slide files__slide";const n=document.createElement("div");n.className="files__item",n.style.cursor="pointer",n.addEventListener("click",(()=>{const e=document.createElement("a");e.href=URL.createObjectURL(s),e.download=s.name,document.body.appendChild(e),e.click(),document.body.removeChild(e),URL.revokeObjectURL(e.href)}));const d=document.createElement("div");d.className="files__preview";const i=document.createElement("div");i.className="files__info";const c=document.createElement("span");c.className="files__name",c.textContent=s.name,c.title=s.name;const r=document.createElement("span");if(r.className="files__size",r.textContent=e(s.size),s.type.startsWith("image/"))try{const e=document.createElement("img");e.alt="File preview",e.className="files__preview-img";const t=await new Promise(((e,t)=>{const a=new FileReader;a.onload=t=>e(t.target.result),a.onerror=t,a.readAsDataURL(s)}));e.src=t,d.appendChild(e)}catch(e){console.error("Error loading image preview:",e),d.innerHTML=t(s.type)}else d.innerHTML=t(s.type);i.appendChild(c),i.appendChild(r),n.appendChild(d),n.appendChild(i),a.appendChild(n),o.appendChild(a)}s.update(),i()}))})(),function(){const e=document.querySelectorAll(".board__note"),t=document.querySelectorAll(".board__column"),s=document.getElementById("createNoteModal"),a=document.querySelector(".board__add-btn"),n=document.querySelector(".modal__close-btn"),o=document.querySelector(".modal__cancel-btn"),d=document.querySelector(".modal__create-btn"),i=document.querySelector(".modal__textarea"),c=document.querySelector(".modal__title"),r=document.createElement("div");r.className="context-menu",r.innerHTML='\n\t\t<div class="context-menu__item" data-action="edit">Редактировать</div>\n\t\t<div class="context-menu__item" data-action="delete">Удалить</div>\n\t',document.body.appendChild(r);let l=null,h=!1;function u(e,t){e.preventDefault(),l=t,r.style.display="block";const s=r.getBoundingClientRect(),a=window.innerHeight,n=window.innerWidth;let o=e.clientY,d=e.clientX;o+s.height>a&&(o=a-s.height),d+s.width>n&&(d=n-s.width),r.style.top=`${o}px`,r.style.left=`${d}px`}function m(){r.style.display="none",l=null}function p(){s.classList.remove("active"),i.value="",h=!1,c.textContent="Создать новую задачу",d.textContent="Создать задачу",d.onclick=v}function v(){if(h)return;const e=i.value.trim();if(e){const t=document.querySelector(".board__column--todo .board__notes"),s=document.createElement("div");s.className="board__note board__note--yellow",s.setAttribute("draggable","true");const a=document.createElement("div");a.className="board__note-content",a.textContent=e,s.appendChild(a),s.addEventListener("dragstart",(e=>{e.dataTransfer.setData("text/plain",a.textContent),s.classList.add("dragging")})),s.addEventListener("dragend",(()=>{s.classList.remove("dragging")})),s.addEventListener("contextmenu",(e=>u(e,s))),t.appendChild(s),p()}}r.addEventListener("click",(e=>{const t=e.target.dataset.action;t&&l&&("edit"===t?function(e){const t=e.querySelector(".board__note-content")||e;i.value=t.textContent,s.classList.add("active"),i.focus(),h=!0,c.textContent="Редактировать задачу",d.textContent="Сохранить",d.onclick=()=>{const e=i.value.trim();e&&(t.textContent=e,p())}}(l):"delete"===t&&l.remove(),m())})),document.addEventListener("click",(e=>{r.contains(e.target)||m()})),a.addEventListener("click",(function(){s.classList.add("active"),i.focus(),h=!1,c.textContent="Создать новую задачу",d.textContent="Создать задачу",d.onclick=v})),n.addEventListener("click",p),o.addEventListener("click",p),d.addEventListener("click",v),s.addEventListener("click",(e=>{e.target===s&&p()})),document.addEventListener("keydown",(e=>{"Escape"===e.key&&s.classList.contains("active")&&p()})),e.forEach((e=>{e.setAttribute("draggable","true"),e.addEventListener("dragstart",(t=>{const s=e.querySelector(".board__note-content")||e;t.dataTransfer.setData("text/plain",s.textContent),e.classList.add("dragging")})),e.addEventListener("dragend",(()=>{e.classList.remove("dragging")})),e.addEventListener("contextmenu",(t=>u(t,e)))})),t.forEach((e=>{e.addEventListener("dragover",(t=>{t.preventDefault(),document.querySelector(".dragging")&&e.querySelector(".board__notes").classList.add("drag-over")})),e.addEventListener("dragleave",(()=>{e.querySelector(".board__notes").classList.remove("drag-over")})),e.addEventListener("drop",(t=>{t.preventDefault();const s=document.querySelector(".dragging");if(s){const t=e.querySelector(".board__notes");t.classList.remove("drag-over"),s.classList.remove("board__note--yellow","board__note--blue","board__note--green"),e.classList.contains("board__column--todo")?s.classList.add("board__note--yellow"):e.classList.contains("board__column--doing")?s.classList.add("board__note--blue"):e.classList.contains("board__column--done")&&s.classList.add("board__note--green"),t.appendChild(s)}}))}))}(),s(),new a}))}();